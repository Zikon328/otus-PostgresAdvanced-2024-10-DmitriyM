### Домашнее задание - Кластер Patroni

#### План и оборудование

- настроим 7 виртуальных машин
- три хоста - кластер DSC ( ETCD )  - [ test-dcs1, test-dcs2, test-dcs3 ]
- три хоста - кластер СУБД  ( Patroni + PostgreSQL ) - [ test-db1, test-db2, test-db3 ]
- хост HaProxy - [ test-proxy ]

- сеть для DCS сделаем отдельной  [ 192.168.1.0 ]
- поэтому на хостах СУБД по две сетевые и по два адреса из разных сегментов [ 192.168.1.0, 192.168.20.0 ]
- на Proxy также два сегмента сети , для доступа к СУБД и для клиентов [ 192.168.20.0 192.168.100.0 ]

- Astra Linux 1.8
- Etcd 3.5.17
- Patroni 4.0.4
- PostgresPro 1C 16
- HaProxy 3.1.2

#### Установка и настройка ETCD

- на 3-х хостах кластера DCS разворачиваем пакет программы ETCD
```
wget
sudo 
```

- записываем файл конфигурации ( меняя параметры для каждого хоста )
```
```

- файл настройки службы уже есть из пакета - и запускаем службы ETCD на кластере DCS 
```
```

- проверяем состояние кластера DCS и его хосты
```
```

#### Установка СУБД

- на 3-х хостах кластера СУБД - разворачиваем PostgresPro 1C 16
- останавливаем службу и проверяем установленные Локальные языки
- во время инициализации кластера PostgreSQL будет определять текущую "локаль" и использует её
```
```

#### Установка и настройка Patroni


- Загружаем подготовленный пакет Patroni для оффлайн установки
- ( в данном пакете есть драйвера и для ETCD и для CONSUL )
- Patroni - программа на Python и зависимые пакеты зависят от версии Python
- ( на старых версиях будут сильно устаревшие пакеты библиотек Python )
- В  SUSE Enterprise Linux 15 - Python 3.6 ( есть оффициальный пакет с Python 3.11, но есть ?? )
- В  Astra Linux 1.7 - Python 3.7  ( сложно обновить до новой версии )
- В  Astra Linux 1.8 - Python 3.11   ( как и в Debian 12 )
- В  Ubuntu 2404 - Рython 3.12
```
```

- шаблон файла настроек Patroni ( исправляем параметры для каждого хоста )
```
```

- файл настройки службы (daemon systemd) для Patroni 
```
```

- запускаем службы Patroni на хостах кластера СУБД
```
```

- проверяем работоспособность кластера
```
```




